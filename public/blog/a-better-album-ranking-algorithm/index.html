<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.f9097e17a74d6fe493dd.css">*,:after,:before{box-sizing:border-box}:after,:before{text-decoration:inherit;vertical-align:inherit}html{cursor:default;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-break:break-word}body{margin:0}h1{font-size:2em;margin:.67em 0}dl dl,dl ol,dl ul,ol dl,ol ol,ol ul,ul dl,ul ol,ul ul{margin:0}hr{height:0;overflow:visible}main{display:block}nav ol,nav ul{list-style:none;padding:0}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}audio,canvas,iframe,img,svg,video{vertical-align:middle}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}iframe,img{border-style:none}svg:not([fill]){fill:currentColor}svg:not(:root){overflow:hidden}table{border-collapse:collapse}button,input,select{margin:0}button{overflow:visible;text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}fieldset{border:1px solid #a0a0a0;padding:.35em .75em .625em}input{overflow:visible}legend{color:inherit;display:table;max-width:100%;white-space:normal}progress{display:inline-block;vertical-align:baseline}select{text-transform:none}textarea{margin:0;overflow:auto;resize:vertical}[type=checkbox],[type=radio]{padding:0}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}details,dialog{display:block}dialog{background-color:#fff;border:solid;color:#000;height:-moz-fit-content;height:-webkit-fit-content;height:fit-content;left:0;margin:auto;padding:1em;position:absolute;right:0;width:-moz-fit-content;width:-webkit-fit-content;width:fit-content}dialog:not([open]){display:none}summary{display:list-item}canvas{display:inline-block}template{display:none}[tabindex],a,area,button,input,label,select,summary,textarea{touch-action:manipulation}[hidden]{display:none}[aria-busy=true]{cursor:progress}[aria-controls]{cursor:pointer}[aria-disabled=true],[disabled]{cursor:not-allowed}[aria-hidden=false][hidden]{display:initial}[aria-hidden=false][hidden]:not(:focus){clip:rect(0,0,0,0);position:absolute}html{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}code,kbd,pre,samp{font-family:Menlo,Consolas,Roboto Mono,"Ubuntu Monospace",Noto Mono,Oxygen Mono,Liberation Mono,monospace,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}</style><meta name="generator" content="Gatsby 2.19.12"/><link rel="alternate" type="application/rss+xml" title="Nikhil Namal • nikhilnamal.netlify.com" href="/rss.xml"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#f9f9f8"/><link rel="apple-touch-icon" sizes="192x192" href="/android-chrome-192x192.png"/><link rel="apple-touch-icon" sizes="512x512" href="/android-chrome-512x512.png"/><title data-react-helmet="true">A Better Album Ranking Algorithm • Nikhil Namal</title><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"/><link data-react-helmet="true" rel="mask-icon" href="/safari-pinned-tab.svg" color="#f2930d"/><meta data-react-helmet="true" name="theme-color" content="#f9f9f8"/><meta data-react-helmet="true" name="apple-mobile-web-app-title" content="nikhil_namal"/><meta data-react-helmet="true" name="application-name" content="nikhil_namal"/><meta data-react-helmet="true" name="msapplication-TileColor" content="#f2930d"/><meta data-react-helmet="true" name="description" content="In its quest to glorify the scrobble, Last.fm has forgotten the humble album. We can almost fix that."/><meta data-react-helmet="true" name="twitter:site" content="@lowmess"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" property="og:site_name" content="Nikhil Namal"/><meta data-react-helmet="true" property="og:title" name="twitter:title" content="A Better Album Ranking Algorithm"/><meta data-react-helmet="true" property="og:url" content="https://nikhilnamal.netlify.com/blog/a-better-album-ranking-algorithm/"/><meta data-react-helmet="true" property="og:description" name="twitter:description" content="In its quest to glorify the scrobble, Last.fm has forgotten the humble album. We can almost fix that."/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-7f057ab76526c2332872.js"/><link as="script" rel="preload" href="/styles-d7bca83241f8e3231f4d.js"/><link as="script" rel="preload" href="/app-849c33fb70df35abcf41.js"/><link as="script" rel="preload" href="/commons-652c8223faa9c70cdf83.js"/><link as="script" rel="preload" href="/component---src-pages-blog-a-better-album-ranking-algorithm-index-mdx-9ea231377164f5c21ce7.js"/><link as="fetch" rel="preload" href="/page-data\blog\a-better-album-ranking-algorithm\page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><style data-emotion-css="f3bn75">html{background-color:#f2930d;line-height:1.5;-webkit-scroll-behavior:smooth;-moz-scroll-behavior:smooth;-ms-scroll-behavior:smooth;scroll-behavior:smooth;}@media (prefers-reduced-motion:reduce){html{-webkit-scroll-behavior:auto;-moz-scroll-behavior:auto;-ms-scroll-behavior:auto;scroll-behavior:auto;}}@media print{html{background:none;}}::selection{background-color:#f2930d !important;color:#443e35 !important;}@media print{nav,footer{display:none !important;}#main-content{margin-bottom:0 !important;}}</style><style data-emotion-css="1qruwav">.css-1qruwav{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100vh;border-color:transparent !important;background-image:url(/topography_900x900.png);background-repeat:repeat;background-position:top center;background-size:900px;}@media (min-resolution:192dpi){.css-1qruwav{background-image:url(/topography_1800x1800.png);}}@media (min-width:48em){.css-1qruwav{background-image:url(/topography_1200x1200.png);background-size:1200px;}}@media (min-width:48em) and (min-resolution:192dpi){.css-1qruwav{background-image:url(/topography_2400x2400.png);}}@media print{.css-1qruwav{display:block;min-height:0;border:0;background:none;}}</style><style data-emotion-css="yy6pts">.css-yy6pts{box-sizing:border-box;margin:0;min-width:0;border:0.5rem solid;background-color:transparent;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100vh;border-color:transparent !important;background-image:url(/topography_900x900.png);background-repeat:repeat;background-position:top center;background-size:900px;}@media screen and (min-width:48em){.css-yy6pts{border:1rem solid;}}@media (min-resolution:192dpi){.css-yy6pts{background-image:url(/topography_1800x1800.png);}}@media (min-width:48em){.css-yy6pts{background-image:url(/topography_1200x1200.png);background-size:1200px;}}@media (min-width:48em) and (min-resolution:192dpi){.css-yy6pts{background-image:url(/topography_2400x2400.png);}}@media print{.css-yy6pts{display:block;min-height:0;border:0;background:none;}}</style><div class="e1aekras0 css-yy6pts"><style data-emotion-css="j20by6">.css-j20by6{box-sizing:border-box;margin:0;min-width:0;-webkit-flex:1;-ms-flex:1;flex:1;max-width:100%;border-radius:0.25rem;padding-top:1rem;padding-bottom:1rem;padding-left:1rem;padding-right:1rem;color:#443e35;background-color:#ffffff;}@media screen and (min-width:48em){.css-j20by6{padding-left:2rem;padding-right:2rem;}}</style><div class="css-j20by6"><style data-emotion-css="xhsa5l">.css-xhsa5l{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;max-width:64rem;height:100%;margin-left:auto;margin-right:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-xhsa5l"><style data-emotion-css="1hzzf6s">.css-1hzzf6s{box-sizing:border-box;margin:0;min-width:0;position:relative;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin-top:0;margin-bottom:4rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}@media screen and (min-width:48em){.css-1hzzf6s{margin-top:0.5rem;margin-bottom:8rem;}}@media screen and (min-width:64em){.css-1hzzf6s{margin-top:1rem;}}</style><nav class="css-1hzzf6s"><style data-emotion-css="1pjd7l6">.css-1pjd7l6{box-sizing:border-box;margin:0;min-width:0;color:inherit;-webkit-text-decoration:none;text-decoration:none;position:absolute;top:0;right:0;bottom:0;left:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:1rem;background-color:#ffffff;font-family:Menlo,Consolas,Roboto Mono,Ubuntu Monospace,Oxygen Mono,Liberation Mono,monospace;font-size:0.875rem;opacity:0;pointer-events:none;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;}.css-1pjd7l6:hover{color:#f2930d;}@media screen and (min-width:48em){.css-1pjd7l6{font-size:1rem;}}.css-1pjd7l6:focus{pointer-events:auto;opacity:1;}</style><a href="#main-content" class="css-1pjd7l6">Skip to main content</a><style data-emotion-css="zkfaav">.css-zkfaav{box-sizing:border-box;margin:0;min-width:0;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-zkfaav"><style data-emotion-css="1w1pv9a">.css-1w1pv9a{box-sizing:border-box;margin:0;min-width:0;color:inherit;-webkit-text-decoration:none;text-decoration:none;display:none;color:#443e35;}@media screen and (min-width:48em){.css-1w1pv9a{display:inline;}}</style><a tabindex="-1" aria-hidden="true" class="css-1w1pv9a" href="/"><p style="color:white;background-color:orange;padding:5px;font-family:monospace;font-weight:600;font-size:15px"> <!-- -->&lt;nikhil.n /&gt;</p><title>Go to homepage</title></a></div><style data-emotion-css="1nh5zdk">.css-1nh5zdk{box-sizing:border-box;margin:0;min-width:0;margin:0;padding:0;list-style-type:none;font-size:0.875rem;font-family:Menlo,Consolas,Roboto Mono,Ubuntu Monospace,Oxygen Mono,Liberation Mono,monospace;}@media screen and (min-width:48em){.css-1nh5zdk{font-size:1rem;}}</style><ul class="css-1nh5zdk"><style data-emotion-css="b6te71">.css-b6te71{box-sizing:border-box;margin:0;min-width:0;display:inline-block;}.css-b6te71 + .css-b6te71{margin-left:0.5rem;}.css-b6te71 a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}.css-b6te71 a:hover{color:#f2930d;}</style><li class="css-b6te71"><a href="/"><style data-emotion-css="1gm6kez">.css-1gm6kez{box-sizing:border-box;margin:0;min-width:0;padding-left:0.25rem;padding-right:0.25rem;padding-bottom:0.25rem;}.active .css-1gm6kez{border-bottom:0.25rem solid;border-color:#f2930d;}</style><span class="css-1gm6kez">Home</span></a></li><li class="css-b6te71"><a href="/projects/"><span class="css-1gm6kez">Projects</span></a></li><li class="css-b6te71"><a class="active" href="/blog/"><span class="css-1gm6kez">Blog</span></a></li><li class="css-b6te71"><a href="/about/"><span class="css-1gm6kez">About</span></a></li></ul></nav><style data-emotion-css="1rhqkbb">.css-1rhqkbb{box-sizing:border-box;margin:0;min-width:0;margin-bottom:4rem;}@media screen and (min-width:48em){.css-1rhqkbb{margin-bottom:8rem;}}</style><main id="main-content" class="css-1rhqkbb"><article><header><style data-emotion-css="13n36at">.css-13n36at{box-sizing:border-box;margin:0;min-width:0;font-size:2.25rem;font-family:heading;font-weight:heading;line-height:heading;font-size:1.25rem;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Oxygen,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.25;font-weight:700;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;margin-bottom:1rem;font-size:2.25rem;}@media screen and (min-width:48em){.css-13n36at{font-size:1.5rem;}}@media screen and (min-width:48em){.css-13n36at{font-size:3rem;}}</style><h1 class="css-13n36at">A Better Album Ranking Algorithm</h1><style data-emotion-css="1wpvqvk">.css-1wpvqvk{box-sizing:border-box;margin:0;min-width:0;font-size:2.25rem;font-family:heading;font-weight:heading;line-height:heading;font-size:1.25rem;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Oxygen,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.25;font-weight:700;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;margin-bottom:2rem;font-size:1.5rem;font-weight:500;}@media screen and (min-width:48em){.css-1wpvqvk{font-size:1.5rem;}}@media screen and (min-width:48em){.css-1wpvqvk{font-size:2.25rem;}}</style><p class="css-1wpvqvk"><time dateTime="2018-03-12">March 12, 2018</time></p><style data-emotion-css="aatphz">.css-aatphz{box-sizing:border-box;margin:0;min-width:0;max-width:8rem;height:0.5rem;margin-top:2rem;margin-left:0;margin-right:0;margin-bottom:4rem;border:0;background-color:#f2930d;}</style><hr class="css-aatphz"/></header><style data-emotion-css="18vl5qo">.css-18vl5qo{box-sizing:border-box;margin:0;min-width:0;line-height:1.5;font-size:1rem;}.css-18vl5qo > *{margin-top:0;margin-bottom:0;}.css-18vl5qo > * + *{margin-top:1rem;}.css-18vl5qo b,.css-18vl5qo strong,.css-18vl5qo em,.css-18vl5qo small,.css-18vl5qo code{line-height:solid;}.css-18vl5qo sup,.css-18vl5qo sub{vertical-align:baseline;position:relative;top:-0.4em;}.css-18vl5qo sub{top:0.4em;}.css-18vl5qo iframe{margin-top:2rem;margin-bottom:2rem;border:1px solid;border-color:#efedea;}.css-18vl5qo details{border-left:0.5rem solid;border-color:#f2930d;border-radius:0.125rem;padding:1rem;margin-top:2rem;margin-bottom:2rem;background-color:#f9f9f8;}@media screen and (min-width:48em){.css-18vl5qo{font-size:1.25rem;}}</style><main class="css-18vl5qo"><style data-emotion-css="b9a69l">.css-b9a69l{box-sizing:border-box;margin:0;min-width:0;max-width:33em;font-size:1rem;line-height:1.5;max-width:33em;margin-top:1rem;}@media screen and (min-width:48em){.css-b9a69l{font-size:1.25rem;}}</style><p class="css-b9a69l">Years ago, I deleted my <style data-emotion-css="vxtv22">.css-vxtv22{box-sizing:border-box;margin:0;min-width:0;color:inherit;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration-color:#f2930d;text-decoration-color:#f2930d;}.css-vxtv22:hover{color:#f2930d;}.css-vxtv22:hover code{color:#f2930d;}@media print{.css-vxtv22:after{content:' (' attr(href) ')';font-size:0.875em;}.css-vxtv22[href^='/']:after{content:' (https://lowmess.com' attr(href) ')';}.css-vxtv22[href^='#']{-webkit-text-decoration:none;text-decoration:none;}.css-vxtv22[href^='#']:after{content:'';}}</style><a href="https://last.fm" class="css-vxtv22">Last.fm</a> account, because it felt like a dying social media network. Months ago, I created <a href="https://www.last.fm/user/lowmess" class="css-vxtv22">a new one</a>, because Last.fm is a treasure trove of behaviorally generated personal data. It’s a lovely service for a developer to have around for side projects, as it provides instant and easy access to a large dataset with a particularly personal connection if you’re a music lover. In the process of using it for <a href="/about/" class="css-vxtv22">one of those side projects</a>, I found a dark &amp; disturbing secret: Last.fm actually kind of sucks for tracking album plays.</p><p class="css-b9a69l">Fair warning: things are about to take a turn for the opinionated, pedantic, and downright trivial.</p><style data-emotion-css="17bh652">.css-17bh652{box-sizing:border-box;margin:0;min-width:0;font-size:2.25rem;font-family:heading;font-weight:heading;line-height:heading;font-size:1.25rem;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Oxygen,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.25;font-weight:700;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;position:relative;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:2rem;padding-top:2rem;font-size:1.25rem;font-weight:600;}@media screen and (min-width:48em){.css-17bh652{font-size:1.5rem;}}.css-17bh652 .heading-link{visibility:hidden;position:absolute;right:100%;padding-left:0.5rem;padding-right:0.5rem;}.css-17bh652 .heading-link:hover{color:#f2930d;}.css-17bh652:hover .heading-link{visibility:visible;}@media screen and (min-width:48em){.css-17bh652{font-size:1.5rem;}}</style><h2 id="the-scrobble-killed-the-record-star" class="css-17bh652"><style data-emotion-css="1wf85w4">.css-1wf85w4{box-sizing:border-box;margin:0;min-width:0;color:inherit;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration-color:#f2930d;text-decoration-color:#f2930d;}.css-1wf85w4:hover{color:#f2930d;}</style><a href="#the-scrobble-killed-the-record-star" class="heading-link css-1wf85w4"><svg viewBox="0 0 32 32" width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M3.04 16A4.966 4.966 0 0 1 8 11.04h6.4V8H8c-4.415 0-8 3.584-8 8s3.585 8 8 8h6.4v-3.04H8A4.966 4.966 0 0 1 3.04 16zm6.56 1.6h12.8v-3.2H9.6v3.2zM24 8h-6.4v3.04H24A4.966 4.966 0 0 1 28.96 16 4.966 4.966 0 0 1 24 20.96h-6.4V24H24c4.415 0 8-3.584 8-8s-3.585-8-8-8z"></path></svg></a>The Scrobble Killed the Record Star</h2><p class="css-b9a69l">Last.fm is built upon an atomic unit: the scrobble. From it, all other units are derived. A scrobble represents one play of one song, and Last.fm sets your top album by how many scrobbles it has. The problem with this is that it’s the complete wrong way to count album plays.</p><p class="css-b9a69l">Album play counts are slightly different than song play counts. They should start from basically the same place — one playthrough is one playthrough — but from there they branch in subtle but important ways. For example, it is much more common to only partially listen to an album than it is to partially listen to a song. Albums are also, generally, between 10 and 12 times longer than songs, and broken into as many parts.</p><p class="css-b9a69l">If the length of an album is what makes a complete playthrough of an album rarer than a playthrough of a song, a playthrough of a longer album should count for more than that of a shorter album. (There’s an argument to be made that the same is true of songs, but we’ll leave that for another day.) Thus, the ideal album ranking algorithm would account for total playthroughs, with a weight given to longer albums. Maybe even something as simple as this:</p><pre><style data-emotion-css="6urk41">.css-6urk41{box-sizing:border-box;margin:0;min-width:0;border-left:0.5rem solid;border-color:#f2930d;border-radius:0.125rem;padding:1rem;width:100%;overflow-x:scroll;margin-top:2rem;margin-bottom:2rem;background-color:#39342d;color:#f9f9f8;font-size:0.875rem;font-family:Menlo,Consolas,Roboto Mono,Ubuntu Monospace,Oxygen Mono,Liberation Mono,monospace;white-space:pre;}@media screen and (min-width:48em){.css-6urk41{font-size:1rem;}}@media print{.css-6urk41{background-color:transparent;color:#443e35;}}.css-6urk41 .token-line{overflow:visible !important;}.css-6urk41 .token:last-child{padding-right:1rem;}</style><div class="prism-code language-js css-6urk41" style="background-color:#39342d;color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><style data-emotion-css="ra9tsr">.css-ra9tsr{box-sizing:border-box;margin:0;min-width:0;display:none;width:1.75em;margin-right:1rem;padding-right:0.5rem;text-align:right;color:#756a5b;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}@media screen and (min-width:48em){.css-ra9tsr{display:inline-block;}}</style><span class="css-ra9tsr">1</span><span class="token plain">albumPlaythroughs </span><span class="token operator" style="color:#f2f99d">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#a89e90">(</span><span class="token number" style="color:#bb68f6">1</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">+</span><span class="token plain"> albumDuration </span><span class="token operator" style="color:#f2f99d">/</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">2700</span><span class="token punctuation" style="color:#a89e90">)</span></div></div></pre><p class="css-b9a69l">Here, we weight the duration in 45 minute increments, the length of a single LP (<style data-emotion-css="1f2zuos">.css-1f2zuos{box-sizing:border-box;margin:0;min-width:0;border:1px solid;border-color:rgba(0,0,0,0.1);border-radius:0.125rem;padding-left:0.25rem;padding-right:0.25rem;background-color:#f9f9f8;color:#443e35;font-size:0.875rem;font-family:Menlo,Consolas,Roboto Mono,Ubuntu Monospace,Oxygen Mono,Liberation Mono,monospace;white-space:nowrap;}@media screen and (min-width:48em){.css-1f2zuos{font-size:1rem;}}</style><code class="css-1f2zuos">albumDuration</code> being in seconds). Adding 1 to the duration calculation helps to ensure we’re not simply normalizing for record length — while that is also a valid way to rank album plays, it is not the one I prefer.</p><h2 id="ok-you-got-me-something-exactly-as-simple-as-that" class="css-17bh652"><a href="#ok-you-got-me-something-exactly-as-simple-as-that" class="heading-link css-1wf85w4"><svg viewBox="0 0 32 32" width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M3.04 16A4.966 4.966 0 0 1 8 11.04h6.4V8H8c-4.415 0-8 3.584-8 8s3.585 8 8 8h6.4v-3.04H8A4.966 4.966 0 0 1 3.04 16zm6.56 1.6h12.8v-3.2H9.6v3.2zM24 8h-6.4v3.04H24A4.966 4.966 0 0 1 28.96 16 4.966 4.966 0 0 1 24 20.96h-6.4V24H24c4.415 0 8-3.584 8-8s-3.585-8-8-8z"></path></svg></a>Ok, You Got Me. Something Exactly As Simple As That</h2><p class="css-b9a69l">Let’s take three albums of varying lengths and see how they handle this algorithm. Our albums:</p><pre><div class="prism-code language-json css-6urk41" style="background-color:#39342d;color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">1</span><span class="token punctuation" style="color:#a89e90">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">2</span><span class="token plain">  </span><span class="token punctuation" style="color:#a89e90">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">3</span><span class="token plain">    </span><span class="token property" style="color:#f2930d">&quot;name&quot;</span><span class="token operator" style="color:#f2f99d">:</span><span class="token plain"> </span><span class="token string" style="color:#f67468">&quot;Cardinal&quot;</span><span class="token punctuation" style="color:#a89e90">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">4</span><span class="token plain">    </span><span class="token property" style="color:#f2930d">&quot;artist&quot;</span><span class="token operator" style="color:#f2f99d">:</span><span class="token plain"> </span><span class="token string" style="color:#f67468">&quot;Pinegrove&quot;</span><span class="token punctuation" style="color:#a89e90">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">5</span><span class="token plain">    </span><span class="token property" style="color:#f2930d">&quot;duration&quot;</span><span class="token operator" style="color:#f2f99d">:</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">1845</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">6</span><span class="token plain">  </span><span class="token punctuation" style="color:#a89e90">}</span><span class="token punctuation" style="color:#a89e90">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">7</span><span class="token plain">  </span><span class="token punctuation" style="color:#a89e90">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">8</span><span class="token plain">    </span><span class="token property" style="color:#f2930d">&quot;name&quot;</span><span class="token operator" style="color:#f2f99d">:</span><span class="token plain"> </span><span class="token string" style="color:#f67468">&quot;Marquee Moon&quot;</span><span class="token punctuation" style="color:#a89e90">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">9</span><span class="token plain">    </span><span class="token property" style="color:#f2930d">&quot;artist&quot;</span><span class="token operator" style="color:#f2f99d">:</span><span class="token plain"> </span><span class="token string" style="color:#f67468">&quot;Television&quot;</span><span class="token punctuation" style="color:#a89e90">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">10</span><span class="token plain">    </span><span class="token property" style="color:#f2930d">&quot;duration&quot;</span><span class="token operator" style="color:#f2f99d">:</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">2754</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">11</span><span class="token plain">  </span><span class="token punctuation" style="color:#a89e90">}</span><span class="token punctuation" style="color:#a89e90">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">12</span><span class="token plain">  </span><span class="token punctuation" style="color:#a89e90">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">13</span><span class="token plain">    </span><span class="token property" style="color:#f2930d">&quot;name&quot;</span><span class="token operator" style="color:#f2f99d">:</span><span class="token plain"> </span><span class="token string" style="color:#f67468">&quot;Summertime &#x27;06&quot;</span><span class="token punctuation" style="color:#a89e90">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">14</span><span class="token plain">    </span><span class="token property" style="color:#f2930d">&quot;artist&quot;</span><span class="token operator" style="color:#f2f99d">:</span><span class="token plain"> </span><span class="token string" style="color:#f67468">&quot;Vince Staples&quot;</span><span class="token punctuation" style="color:#a89e90">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">15</span><span class="token plain">    </span><span class="token property" style="color:#f2930d">&quot;duration&quot;</span><span class="token operator" style="color:#f2f99d">:</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">3545</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">16</span><span class="token plain">  </span><span class="token punctuation" style="color:#a89e90">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">17</span><span class="token plain"></span><span class="token punctuation" style="color:#a89e90">]</span></div></div></pre><p class="css-b9a69l">Given one playthrough each, the three records will be ranked in exactly the same order they are now. Let’s listen to a few more tracks.</p><pre><div class="prism-code language-js css-6urk41" style="background-color:#39342d;color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">1</span><span class="token keyword" style="color:#f2930d">const</span><span class="token plain"> cardinalRank </span><span class="token operator" style="color:#f2f99d">=</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">3.5</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#a89e90">(</span><span class="token number" style="color:#bb68f6">1</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">+</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">1845</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">/</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">2700</span><span class="token punctuation" style="color:#a89e90">)</span><span class="token plain"> </span><span class="token comment" style="color:#938776">// 5.89</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">2</span><span class="token plain"></span><span class="token keyword" style="color:#f2930d">const</span><span class="token plain"> marqueeRank </span><span class="token operator" style="color:#f2f99d">=</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">3</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#a89e90">(</span><span class="token number" style="color:#bb68f6">1</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">+</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">2745</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">/</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">2700</span><span class="token punctuation" style="color:#a89e90">)</span><span class="token plain"> </span><span class="token comment" style="color:#938776">// 6.05</span><span class="token plain"></span></div><div class="token-line" style="color:#f9f9f8;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;tab-size:2;hyphens:none;overflow:auto"><span class="css-ra9tsr">3</span><span class="token plain"></span><span class="token keyword" style="color:#f2930d">const</span><span class="token plain"> summertimeRank </span><span class="token operator" style="color:#f2f99d">=</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">2.5</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#a89e90">(</span><span class="token number" style="color:#bb68f6">1</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">+</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">3545</span><span class="token plain"> </span><span class="token operator" style="color:#f2f99d">/</span><span class="token plain"> </span><span class="token number" style="color:#bb68f6">2700</span><span class="token punctuation" style="color:#a89e90">)</span><span class="token plain"> </span><span class="token comment" style="color:#938776">// 5.78</span></div></div></pre><p class="css-b9a69l">Now we’re getting somewhere. Even though <em>Cardinal</em> has the most playthroughs, <em>Marquee Moon</em> has the highest rank thanks to its lengthier runtime. <em>Summertime ‘06</em> is just barely in third place despite having a full playthrough less than <em>Cardinal</em>. The system works, folks.</p><h2 id="this-is-the-part-with-the-but" class="css-17bh652"><a href="#this-is-the-part-with-the-but" class="heading-link css-1wf85w4"><svg viewBox="0 0 32 32" width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M3.04 16A4.966 4.966 0 0 1 8 11.04h6.4V8H8c-4.415 0-8 3.584-8 8s3.585 8 8 8h6.4v-3.04H8A4.966 4.966 0 0 1 3.04 16zm6.56 1.6h12.8v-3.2H9.6v3.2zM24 8h-6.4v3.04H24A4.966 4.966 0 0 1 28.96 16 4.966 4.966 0 0 1 24 20.96h-6.4V24H24c4.415 0 8-3.584 8-8s-3.585-8-8-8z"></path></svg></a>This Is the Part With the “But”</h2><p class="css-b9a69l">Given all the information we need, the algorithm works. But we still have to get the information, and unfortunately, Last.fm doesn’t make it too easy on us:</p><style data-emotion-css="iatzw7">.css-iatzw7{box-sizing:border-box;margin:0;min-width:0;margin-top:1rem;padding-left:2rem;}.css-iatzw7 ul,.css-iatzw7 ol{margin-top:0;margin-bottom:0;}</style><ul class="css-iatzw7"><li>We can easily get a user’s top albums, but the response doesn’t include information on the amount of tracks on, or duration of, each album.</li><li>Last.fm doesn’t use unique IDs to track albums, so we have to use an endpoint that searches by album name and artist to get detailed album information. This often fails or retrieves the wrong album, even when the album name and artist are provided by Last.fm (like from the previously discussed endpoint).</li><li>Once we find an album, track listings are missing or incomplete about 20% of the time. This happens more often with newer albums.</li><li>Neither the top albums nor album info endpoints give us the album’s release year. This doesn’t impact the algorithm, I just thought it was odd.</li></ul><p class="css-b9a69l">All told, to implement this algorithm on our own means we would have to make an insane amount of requests just to get incomplete or missing data. If you think that doesn’t sound like it’s worth it, you’re right. And while I didn’t use it, <a href="https://gist.github.com/lowmess/f3c03b1a6fe50ee04622706047f8a654" class="css-vxtv22">you can see an implementation here</a>.</p><p class="css-b9a69l">Last.fm still ranks albums wrong, though.</p></main></article></main><style data-emotion-css="n1swva">.css-n1swva{box-sizing:border-box;margin:0;min-width:0;font-family:Menlo,Consolas,Roboto Mono,Ubuntu Monospace,Oxygen Mono,Liberation Mono,monospace;margin-top:auto;margin-bottom:1rem;}@media screen and (min-width:48em){.css-n1swva{margin-bottom:1rem;}}@media screen and (min-width:64em){.css-n1swva{margin-bottom:2rem;}}</style><footer class="css-n1swva"><style data-emotion-css="ymqbme">.css-ymqbme{box-sizing:border-box;margin:0;min-width:0;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}@media screen and (min-width:48em){.css-ymqbme{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media screen and (min-width:64em){.css-ymqbme{-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}}</style><div class="css-ymqbme"><style data-emotion-css="clzlpd">.css-clzlpd{box-sizing:border-box;margin:0;min-width:0;display:none;}@media screen and (min-width:48em){.css-clzlpd{display:none;}}@media screen and (min-width:64em){.css-clzlpd{display:block;}}</style><div class="css-clzlpd"><style data-emotion-css="op4fzj">.css-op4fzj{box-sizing:border-box;margin:0;min-width:0;margin-right:0.5rem;}</style><span class="css-op4fzj">From the blog:</span><style data-emotion-css="1w0r8xu">.css-1w0r8xu{box-sizing:border-box;margin:0;min-width:0;color:inherit;-webkit-text-decoration:none;text-decoration:none;}.css-1w0r8xu:hover{color:#f2930d;}</style><a class="css-1w0r8xu" href="/blog/no-red-squigglies-for-semicolons/"><style data-emotion-css="1jewwb">.css-1jewwb{box-sizing:border-box;margin:0;min-width:0;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:0.875rem;font-family:Menlo,Consolas,Roboto Mono,Ubuntu Monospace,Oxygen Mono,Liberation Mono,monospace;font-weight:700;}@media screen and (min-width:48em){.css-1jewwb{font-size:1rem;}}</style><span class="css-1jewwb">No Red Squigglies For Semicolons<!-- --> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 16" width="24" height="16" preserveAspectRatio="xMinYMid"><path d="M8 8.61V7.39h12V4l4 4-4 4V8.61H8z"></path></svg></span></a></div><style data-emotion-css="1h275wr">.css-1h275wr{box-sizing:border-box;margin:0;min-width:0;margin:0;padding:0;list-style-type:none;}</style><ul class="css-1h275wr"><style data-emotion-css="177x7e8">.css-177x7e8{box-sizing:border-box;margin:0;min-width:0;display:inline-block;}.css-177x7e8 + .css-177x7e8{margin-left:1rem;}</style><li class="css-177x7e8"><style data-emotion-css="aizcs3">.css-aizcs3{box-sizing:border-box;margin:0;min-width:0;color:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:0.875rem;}.css-aizcs3:hover{color:#f2930d;}@media screen and (min-width:48em){.css-aizcs3{font-size:1rem;}}</style><a href="https://twitter.com/Nikhil17_namal" class="css-aizcs3">Twitter</a></li><li class="css-177x7e8"><a href="https://github.com/NikhilNamal17" class="css-aizcs3">GitHub</a></li><li class="css-177x7e8"><a href="https://bit.ly/nikhil-namal-resume" class="css-aizcs3">Résumé</a></li></ul></div></footer></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/a-better-album-ranking-algorithm/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-849c33fb70df35abcf41.js"],"component---src-pages-404-jsx":["/component---src-pages-404-jsx-30314d2e7ee1d43f6ff5.js"],"component---src-pages-about-jsx":["/component---src-pages-about-jsx-ee287ff1b3b8667955ec.js"],"component---src-pages-blog-jsx":["/component---src-pages-blog-jsx-0848696ebc2f60fb7b5b.js"],"component---src-pages-colophon-jsx":["/component---src-pages-colophon-jsx-c6e8c9983da31c090dd8.js"],"component---src-pages-index-jsx":["/component---src-pages-index-jsx-8d965c59b51a23aba1f0.js"],"component---src-pages-projects-jsx":["/component---src-pages-projects-jsx-2071d864f5d83df34ca5.js"],"component---src-pages-blog-a-better-album-ranking-algorithm-index-mdx":["/component---src-pages-blog-a-better-album-ranking-algorithm-index-mdx-9ea231377164f5c21ce7.js"],"component---src-pages-blog-a-form-fitted-z-shell-index-mdx":["/component---src-pages-blog-a-form-fitted-z-shell-index-mdx-ba72cbd8610a54a926cc.js"],"component---src-pages-blog-customizing-tachyons-index-mdx":["/component---src-pages-blog-customizing-tachyons-index-mdx-904f4f0d252d61cd06ad.js"],"component---src-pages-blog-fetch-with-timeout-index-mdx":["/component---src-pages-blog-fetch-with-timeout-index-mdx-4e5ff46ac778a918ab23.js"],"component---src-pages-blog-functional-first-accordions-index-mdx":["/component---src-pages-blog-functional-first-accordions-index-mdx-58dec18a6c36d4791634.js"],"component---src-pages-blog-no-red-squigglies-for-semicolons-index-mdx":["/component---src-pages-blog-no-red-squigglies-for-semicolons-index-mdx-1e4abb55d2b18a92bc46.js"],"component---src-pages-blog-on-declarative-styling-index-mdx":["/component---src-pages-blog-on-declarative-styling-index-mdx-02cbcd66d26cacc47de0.js"]};/*]]>*/</script><script src="/component---src-pages-blog-a-better-album-ranking-algorithm-index-mdx-9ea231377164f5c21ce7.js" async=""></script><script src="/commons-652c8223faa9c70cdf83.js" async=""></script><script src="/app-849c33fb70df35abcf41.js" async=""></script><script src="/styles-d7bca83241f8e3231f4d.js" async=""></script><script src="/webpack-runtime-7f057ab76526c2332872.js" async=""></script></body></html>