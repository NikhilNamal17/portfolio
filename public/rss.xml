<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Nikhil Namal • nikhilnamal.netlify.com]]></title><description><![CDATA[Hi, I'm Nikhil Namal. I'm a full stack developer.  I like dabbling in various parts of development and like to learn about new technologies, make memes or simply play games in my free time.]]></description><link>https://nikhilnamal.netlify.com</link><generator>GatsbyJS</generator><lastBuildDate>Tue, 24 Mar 2020 22:30:30 GMT</lastBuildDate><item><title><![CDATA[No Red Squigglies For Semicolons]]></title><description><![CDATA[Linters are powerful code quality tools. Stylistic consistency is important. Linters should never enforce stylistic consistency.]]></description><link>https://nikhilnamal.netlify.com/blog/no-red-squigglies-for-semicolons/</link><guid isPermaLink="false">https://nikhilnamal.netlify.com/blog/no-red-squigglies-for-semicolons/</guid><pubDate>Wed, 04 Dec 2019 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Us developers are an opinionated bunch. We share our opinions wide and loud through blog posts, tweets, talks at meetups, in meetings. The tenacity with which we hold these opinions seems to have &lt;a href=&quot;https://en.wikipedia.org/wiki/Law_of_triviality&quot;&gt;an inverse correlation with their impact&lt;/a&gt;, and nowhere is this strange dichotomy more present than in stylistic choices. Should we use tabs or spaces for whitespace? Should we use semicolons or not? Single quotes or double quotes?&lt;/p&gt;&lt;p&gt;Collectively, these stylistic choices are known as bikeshedding. Thousands of words have been written about how we should be painting our bikesheds. We have many tools to help us paint the bikeshed. But, truth be told, I don’t care much about what color the bikeshed is. What I do care about is my code editor’s linting extension putting a red squiggly line under a function declaration because there’s a space between the name of the function and its parameter list.&lt;/p&gt;&lt;h2&gt;Linters Are For Code Quality, Formatters Are For Style&lt;/h2&gt;&lt;p&gt;Linters are incredible code quality tools. They enforce best patterns and can help catch bugs well before our code makes it to a browser. But they are ill-equipped to handle issues of style. Attempting to use an undefined variable is a bug, and your linter should point this out to you. Using single quotes instead of double quotes, on the other hand, will not impact your code’s logic or ability to run. As such, your linter should not care about this issue. At the very least it should not interrupt your work to tell you about it.&lt;/p&gt;&lt;p&gt;Formatters are a different kind of tool altogether. They care only about enforcing a consistent style and rarely (if ever) give real-time feedback. Instead, they wait until your work is at a safe stopping point to run: when you save a file, when you commit, or when you explicitly tell the formatter to run. Because of this, they are much less likely to introduce friction into your workflow.&lt;/p&gt;&lt;p&gt;In the JavaScript world the most used linter is &lt;a href=&quot;https://eslint.org&quot;&gt;ESLint&lt;/a&gt;, and the most used formatter is &lt;a href=&quot;https://prettier.io&quot;&gt;Prettier&lt;/a&gt;. &lt;a href=&quot;/colophon/&quot;&gt;They’re what I use&lt;/a&gt; across my projects. Unfortunately, many popular ESLint configs include strict enforcement of stylistic rules. Recognizing that conflicts between the two tools would arise, the Prettier team created &lt;a href=&quot;https://github.com/prettier/eslint-config-prettier&quot;&gt;&lt;code&gt;eslint-config-prettier&lt;/code&gt;&lt;/a&gt;. The aptly-named ESLint config turns off any rules that conflict with Prettier, giving it full dominion over all issues of style. Using it allows us to keep the code quality benefits of our linter, only without those pesky bikeshedding errors.&lt;/p&gt;&lt;h2&gt;If You Have to Remember To Do It, You’ll Forget To Do It&lt;/h2&gt;&lt;p&gt;The workflow friction does not stop with squiggly lines, of course. If your setup relies on you to remember to run a linter or formatter (or test suite) against your code, you will forget to do so. Probably not every time, maybe even not most of the time, but &lt;em&gt;definitely&lt;/em&gt; some of the time. This is especially true when working in a shared codebase: we can’t be sure all members of our team have the same linting &amp;amp; formatting extensions installed, that those extenstions are configured the same way, or be sure our teammates will remember to run those tools manually. Instead, I find it better to set these tools up to run with Git hooks.&lt;/p&gt;&lt;p&gt;Git hooks allow us to run arbitrary commands when performing a Git function; they allow us to run scripts before or after committing or pushing or pulling. While possible to &lt;a href=&quot;https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks&quot;&gt;set these hooks up manually&lt;/a&gt;, tools like &lt;a href=&quot;https://github.com/typicode/husky&quot;&gt;husky&lt;/a&gt; make setting them up much easier. I also often use a tool called &lt;a href=&quot;https://github.com/okonet/lint-staged&quot;&gt;lint-staged&lt;/a&gt; to lint &amp;amp; format only those files staged for commit. This makes the process much faster, and ensures that no extraneous files are included in a commit.&lt;/p&gt;&lt;p&gt;Combined with removing bikeshedding rules from your linter, introducing a formatter and setting up Git hooks will remove a fair amount of friction from your code writing process. Setting these tools up — ESLint, Prettier, husky, &amp;amp; lint-staged — are among the first things I do in any new JavaScript project. I highly recommend giving it a shot.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[On Declarative Styling]]></title><description><![CDATA[By limiting the amount of CSS we can write, we improve the quality of the CSS we do write.]]></description><link>https://nikhilnamal.netlify.com/blog/on-declarative-styling/</link><guid isPermaLink="false">https://nikhilnamal.netlify.com/blog/on-declarative-styling/</guid><pubDate>Fri, 19 Jul 2019 00:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;&lt;p&gt;The enemy of art is the absence of limitations.&lt;/p&gt;&lt;cite&gt;Orson Welles&lt;/cite&gt;&lt;/blockquote&gt;&lt;p&gt;There is a problem at the heart of CSS. It’s not the cascade, or specificity, or inconsistencies between rendering engines — though these things can be annoying. No, it’s much simpler than that: the problem is that we can write too much of it.&lt;/p&gt;&lt;p&gt;I am not talking about &lt;a href=&quot;https://css-tricks.com/oh-no-stylesheet-grows-grows-grows-append-stylesheet-problem/&quot;&gt;append-only stylesheets&lt;/a&gt; (though these too cause their issues). Even if we’re extremely disciplined about refactoring our CSS, and we only add new rules when absolutely needed, something is still wrong. The problem is the flexibility of the language itself. There are nearly unlimited valid values that a &lt;code&gt;padding&lt;/code&gt; declaration can take, and while extremely freeing this also introduces surface area for inconsistencies in our designs. And consistency is key to good design! It reduces the end user’s cognitive load, it (generally) looks better, and it minimizes the workload for designers &amp;amp; developers to boot.&lt;/p&gt;&lt;p&gt;Artificially limiting the number of values that we can use in declarations is key to avoiding these inconsistencies. We want a declaration like &lt;code&gt;padding&lt;/code&gt; to act a little more like &lt;code&gt;float&lt;/code&gt;; we should only be able to set a value that we’ve defined in our governing system. There are many techniques and technologies that can help us accomplish this (or at least get us close). I call the overarching concept that these tools encompass “declarative styling”.&lt;/p&gt;&lt;h2&gt;Defining “Declarative”&lt;/h2&gt;&lt;p&gt;This term — declarative styling — is derived from the computer science concept &lt;a href=&quot;https://en.wikipedia.org/wiki/Declarative_programming&quot;&gt;declarative programming&lt;/a&gt;. It means we want to tell the computer the rules for drawing our interface, and let it follow those rules for us. We no longer want to write &lt;code&gt;padding: 1rem&lt;/code&gt;, we want to write something like &lt;code&gt;padding: 3&lt;/code&gt; and have the computer replace the &lt;code&gt;3&lt;/code&gt; with the 3rd value in our spacing scale.&lt;/p&gt;&lt;p&gt;This accomplishes several things for us. It ensures consistency across our design by allowing us to use a reference rather than a specific value. It also reduces the cognitive load for stakeholders by providing a common language to communicate in. These factors (among others) can make designing and iterating faster, and all but eliminate the inherent friction in designer-developer handoff.&lt;/p&gt;&lt;h2&gt;Design Tokens&lt;/h2&gt;&lt;p&gt;Those familiar with the concept of &lt;a href=&quot;https://css-tricks.com/what-are-design-tokens/&quot;&gt;design tokens&lt;/a&gt; may find a lot of conceptual overlap here. Design tokens are an essential part of declarative styling: they are how we define our custom subset of styling options. If a rule in our stylesheet declares a &lt;code&gt;background-color&lt;/code&gt;, that swatch should be found in our tokens.&lt;/p&gt;&lt;p&gt;There are many techniques for storing and parsing design tokens. I’m partial to the JSON-based &lt;a href=&quot;https://system-ui.com/theme&quot;&gt;System UI theme specification&lt;/a&gt;, which organizes our tokens into a variety of scales. Several of the tools discussed below rely on this or a similar technique, but the concept remains the same: there should be a source of truth for these values, and it should not be the CSS rule itself.&lt;/p&gt;&lt;h2&gt;Techniques&lt;/h2&gt;&lt;p&gt;Much like there are a multitude of ways to store our tokens, there are many, many ways to apply them to our styles.&lt;/p&gt;&lt;h3&gt;CSS Variables&lt;/h3&gt;&lt;p&gt;The most commonly-used solution, and one you’re likely familiar with, is to use variables whenever possible. Although Sass and LESS have had variables since their inception, CSS now has native variable support &lt;a href=&quot;http://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties&quot;&gt;with the custom properties specification&lt;/a&gt;.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot;&gt;.box {
  padding: var(--spacing-3);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Unlike the variables of preprocessors like Sass and LESS, custom properties can take full advantage of the cascade. This means we can create fully themeable component styles natively.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot;&gt;.btn {
  /* First we define our variables in the base component style */
  --button-padding-y: var(--spacing-2);
  --button-padding-x: var(--spacing-3);
  /* Then we apply our variables to our declarations */
  padding: var(--button-padding-y) var(--button-padding-x);
}

/* By updating our variables, the styles will change automatically */
.btn--large {
  --button-padding-y: var(--spacing-3);
  --button-padding-x: var(--spacing-4);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To take full advantage of this system, we need to convert our tokens to custom properties in the &lt;code&gt;:root&lt;/code&gt; selector. The easiest way to do this is to copy and paste the values by hand, though there are &lt;a href=&quot;https://github.com/salesforce-ux/theo&quot;&gt;tools to automate the process&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Of course, no method is without a downside. In this case, the biggest flaw is the same as its biggest draw: the low barrier to entry. There are no guardrails to stop you from writing &lt;code&gt;padding: 24px&lt;/code&gt; instead of using your variable. It takes a lot of discipline to not deviate from the system, and any time you’re writing new CSS is an opportunity to create a discrepancy. But combined with a strict code review process, this can be a powerful way of enforcing consistency while creating a themeable system.&lt;/p&gt;&lt;h3&gt;Atomic CSS&lt;/h3&gt;&lt;p&gt;Atomic CSS (aka Functional CSS, aka Utility-first CSS) libraries like BassCSS, Tachyons, and Tailwind CSS are declarative by definition. Classes like &lt;code&gt;p3&lt;/code&gt; automatically follow our &lt;code&gt;padding&lt;/code&gt; rule from above: we’re telling the engine to apply equal padding to all sides (the &lt;code&gt;p&lt;/code&gt;) using the third step from our spacing scale (the &lt;code&gt;3&lt;/code&gt;).&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div class=&amp;quot;p3&amp;quot;&amp;gt;Hi&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Customizing BassCSS and Tachyons can be tough, &lt;a href=&quot;/blog/customizing-tachyons/&quot;&gt;but it is possible&lt;/a&gt;. Tailwind, on the other hand, is &lt;a href=&quot;https://tailwindcss.com/docs/configuration&quot;&gt;fully customizable by default&lt;/a&gt;. The Tailwind configuration system is a plain JS object exported from a Node script. A major benefit to this approach is that we can read our tokens from a JSON or YAML file, and apply them to our custom config with a few lines of code.&lt;/p&gt;&lt;p&gt;I’m on the record as being a big, big fan of atomic CSS. But I’m not blind to the disadvantages. The learning curve can be quite steep; not only do we need to internalize the naming scheme, but we also need to rethink how we apply our CSS. Because we also need to apply a fair amount of classnames to our components, I also tend to recommend this approach only for very simple projects or for projects that have a powerful templating system. Applying atomic CSS classes to a React component or Pug mixin makes applying the classnames to our elements much more palatable.&lt;/p&gt;&lt;h3&gt;Styled System&lt;/h3&gt;&lt;p&gt;The advent of CSS-in-JS has presented us with a unique opportunity: by taking advantage of an expressive, fully-featured programming language, we can create abstractions on top of CSS that would otherwise be impossible. For example, by taking the lessons learned from atomic CSS and applying them to a JSX-based CSS-in-JS system, &lt;a href=&quot;https://jxnblk.com/&quot;&gt;Brent Jackson&lt;/a&gt; has created several purpose-built declarative styling libraries.&lt;/p&gt;&lt;p&gt;The first of these libraries, the foundation upon which the others are built, is called &lt;a href=&quot;https://styled-system.com/&quot;&gt;Styled System&lt;/a&gt;. The library provides a consistent interface to refer to your design tokens when defining or consuming a component. The true genius of Styled System is &lt;a href=&quot;https://styled-system.com/responsive-styles&quot;&gt;how it handles responsive styles&lt;/a&gt;. By default, Styled System props accept a string, which the library parses and converts to a value represented by a design token. If the token is not found, the literal value is passed to the underlying CSS-in-JS library. However, by passing a prop an array, it will apply the 0-index value to the component by default, the 1-index value to the component at the first breakpoint, and so on and so forth.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-jsx&quot;&gt;import styled from &apos;styled-components&apos;
import { space, color } from &apos;styled-system&apos;

const Box = styled.div`
  ${space}
  ${color}
`

const MyStyledSystemComponent = props =&amp;gt; (
  &amp;lt;Box p={[2, 3]} color=&amp;quot;primary&amp;quot; {...props}&amp;gt;
    Hi
  &amp;lt;/Box&amp;gt;
)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This approach allows us to not only create components that are not only consistent with our system, but are extremely portable as well. A rule of thumb I try to follow when styling a component is to only define surrounding vertical margin when the component is actually consumed in a view. By spreading our props to a root component defined with Styled System, it becomes trivial to follow this rule.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-jsx&quot;&gt;const MyView = () =&amp;gt; (
  &amp;lt;main&amp;gt;
    &amp;lt;header&amp;gt;...&amp;lt;/header&amp;gt;

    &amp;lt;MyStyledSystemComponent my=&amp;quot;4&amp;quot; /&amp;gt;

    &amp;lt;footer&amp;gt;...&amp;lt;/footer&amp;gt;
  &amp;lt;/main&amp;gt;
)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Because Styled System (when used in React) reads from the theme put into context from your CSS-in-JS library of choice’s &lt;code&gt;ThemeProvider&lt;/code&gt;, creating themeable components is a breeze. However, attaching &lt;code&gt;space&lt;/code&gt;, &lt;code&gt;color&lt;/code&gt;, and other token references to all your components can be quite annoying. Luckily, Mr. Jackson has also created a library of primitive components built on top of Styled System called &lt;a href=&quot;https://rebassjs.org/&quot;&gt;Rebass&lt;/a&gt;. These components operate like the &lt;code&gt;Box&lt;/code&gt; component we utilized inside of &lt;code&gt;MyStyledSystemComponent&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Most recently, Brent has released &lt;a href=&quot;https://theme-ui.com/&quot;&gt;Theme UI&lt;/a&gt;, a further iteration of this idea. Theme UI exposes an &lt;code&gt;sx&lt;/code&gt; prop on JSX components that allows us to reference our tokens, provides primitive components to use as a foundation, handles styling of markdown content with MDX, and much, much more. It’s an exciting evolution of the approach, and one I intend to explore more fully in the future.&lt;/p&gt;&lt;p&gt;The Styled System approach, much like the others, comes with its fair share of downsides. For starters, it shares the same learning curve problem as atomic CSS. It can be somewhat cumbersome to set up, particularly when not using Rebass or Theme UI’s primitive components. And while it can technically work with any framework that supports JSX, React is the only true first-class Styled System citizen. But, when given a choice, it is still my preferred method for defining and consuming styles.&lt;/p&gt;&lt;h2&gt;A Vision of the Future&lt;/h2&gt;&lt;p&gt;The web has always been an extremely flexible and expressive platform. This has lead to some amazing creative applications of technology, new media experiences, and beautiful interactions. It has also created plenty of &lt;a href=&quot;https://en.wiktionary.org/wiki/footgun&quot;&gt;footgun&lt;/a&gt; opportunities. By placing self-imposed constraints on the very fabric of the web, we get to remove the more self-sabotaging aspects of designing for the platform. Rather than limiting our creativity, these constraints provide guardrails for us to explore the limits of our designs while providing a consistent and visually harmonious interface to our users.&lt;/p&gt;&lt;p&gt;The declarative styling methodology will continue to evolve over time. As design tokens become more prevalent, design software will add first-class support for them. More libraries and methods will evolve for applying them to our products, both on the web and beyond. As we solve the problem at the heart of CSS, the language we use to communicate between ideation and implementation will meld into one. Perhaps our tools will as well.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Request Timeouts With the Fetch API]]></title><description><![CDATA[The Fetch API is great, but didn't ship with the ability to timeout requests. There's a new API to help with that.]]></description><link>https://nikhilnamal.netlify.com/blog/fetch-with-timeout/</link><guid isPermaLink="false">https://nikhilnamal.netlify.com/blog/fetch-with-timeout/</guid><pubDate>Sat, 30 Mar 2019 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;I’m a big fan of the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API&quot;&gt;Fetch API&lt;/a&gt;. I use it regularly in all sorts of projects, including this site and the API that powers the stats on the &lt;a href=&quot;/about/&quot;&gt;about page&lt;/a&gt;. However it isn’t always as clear how to do things like error handling and request timeouts as it is in libraries like &lt;a href=&quot;https://github.com/axios/axios&quot;&gt;Axios&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;If you’re not familiar with &lt;code&gt;fetch&lt;/code&gt;, it’s a native API that massively simplifies making AJAX requests compared to the older &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/XMLHTTPRequest&quot;&gt;XHR&lt;/a&gt; method, and &lt;a href=&quot;https://caniuse.com/#feat=fetch&quot;&gt;it’s supported in all modern browsers&lt;/a&gt;. When it initially landed, however, there was no easy way to handle request timeouts. You could fake it with &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/race&quot;&gt;&lt;code&gt;Promise.race&lt;/code&gt;&lt;/a&gt; or by &lt;a href=&quot;https://github.com/github/fetch/issues/175#issuecomment-216791333&quot;&gt;wrapping your &lt;code&gt;fetch&lt;/code&gt; in another Promise&lt;/a&gt;, but these solutions don’t actually cancel the request. This is where &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/AbortController&quot;&gt;&lt;code&gt;AbortController&lt;/code&gt;&lt;/a&gt; comes in.&lt;/p&gt;&lt;p&gt;&lt;code&gt;AbortController&lt;/code&gt; is an API that, much like its name and my previous sentence suggests, allows us to abort (cancel) requests. Though &lt;a href=&quot;https://caniuse.com/#feat=abortcontroller&quot;&gt;browser support isn’t &lt;em&gt;wonderful&lt;/em&gt; at time of writing&lt;/a&gt;, it can be used in most modern browsers and &lt;a href=&quot;https://github.com/mo/abortcontroller-polyfill&quot;&gt;polyfills are available&lt;/a&gt;. The API itself has a very small surface area: a &lt;code&gt;signal&lt;/code&gt; property to attach to request objects, and an &lt;code&gt;abort&lt;/code&gt; method to actually cancel the request. Because the API is so simple, it’s very flexible — Jake Archibald has &lt;a href=&quot;https://developers.google.com/web/updates/2017/09/abortable-fetch&quot;&gt;a fairly in-depth article on the Google Developers blog&lt;/a&gt; going over various cancellation scenarios, as well as the history behind the API, and I highly recommend giving it a read.&lt;/p&gt;&lt;p&gt;With &lt;code&gt;AbortController&lt;/code&gt;, it becomes trivial to cancel a request if it doesn’t resolve before a given period of time: if the &lt;code&gt;abort&lt;/code&gt; method is called before the request resolves (or before the response &lt;code&gt;Body&lt;/code&gt; is consumed), the request is cancelled; if it’s called after, the browser just ignores the call. To put it all together, we need to:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Create an instance of &lt;code&gt;AbortController&lt;/code&gt;&lt;/li&gt;&lt;li&gt;Create a &lt;code&gt;setTimeout&lt;/code&gt; function that calls the controller’s &lt;code&gt;abort&lt;/code&gt; method&lt;/li&gt;&lt;li&gt;Pass the controller’s &lt;code&gt;signal&lt;/code&gt; to &lt;code&gt;fetch&lt;/code&gt;’s options object&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;Putting It All Together&lt;/h2&gt;&lt;p&gt;First, because we’re basically writing a shim around &lt;code&gt;fetch&lt;/code&gt;, I’m going to add an extra little perk. If the response doesn’t return in the &lt;code&gt;200&lt;/code&gt; range (that is, if &lt;code&gt;response.ok&lt;/code&gt; evaluates to &lt;code&gt;false&lt;/code&gt;), we’re going to throw an error. We absolutely do not need to do this — we could just catch our timeout and the function would work the same (we actually don’t even &lt;em&gt;need&lt;/em&gt; to do that). However, I always perform this check anyways, so this removes a lot of boilerplate code for me.&lt;/p&gt;&lt;p&gt;Anyways, here is my generic &lt;code&gt;fetchWithTimeout&lt;/code&gt; function. It should work in any environment that supports &lt;code&gt;fetch&lt;/code&gt; and &lt;code&gt;AbortController&lt;/code&gt;.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;const fetchWithTimeout = (uri, options = {}, time = 5000) =&amp;gt; {
  // Lets set up our `AbortController`, and create a request options object
  // that includes the controller&apos;s `signal` to pass to `fetch`.
  const controller = new AbortController()
  const config = { ...options, signal: controller.signal }

  // Set a timeout limit for the request using `setTimeout`. If the body of this
  // timeout is reached before the request is completed, it will be cancelled.
  const timeout = setTimeout(() =&amp;gt; {
    controller.abort()
  }, time)

  return fetch(uri, config)
    .then(response =&amp;gt; {
      // Because _any_ response is considered a success to `fetch`,
      // we need to manually check that the response is in the 200 range.
      // This is typically how I handle that.
      if (!response.ok) {
        throw new Error(`${response.status}: ${response.statusText}`)
      }

      return response
    })
    .catch(error =&amp;gt; {
      // When we abort our `fetch`, the controller conveniently throws a named
      // error, allowing us to handle them separately from other errors.
      if (error.name === &apos;AbortError&apos;) {
        throw new Error(&apos;Response timed out&apos;)
      }

      throw new Error(error.message)
    })
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Using the function is fairly straightforward. Because we return &lt;code&gt;fetch&lt;/code&gt; directly, we can use it in much the same way; the only change should be the addition of a third parameter (our &lt;code&gt;time&lt;/code&gt; argument) and the extra error handling we discussed above.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;// This example _always_ logs the error, because I&apos;m telling httpstat.us to wait
// at least 1s before responding, but setting the timeout threshold to 500ms.
// Also, this could definitely be written in async/await if you preferred.
fetchWithTimeout(
  &apos;https://httpstat.us/200?sleep=1000&apos;,
  { headers: { Accept: &apos;application/json&apos; } },
  500
)
  .then(response =&amp;gt; response.json())
  .then(json =&amp;gt; {
    console.log(`This will never log out: ${json}`)
  })
  .catch(error =&amp;gt; {
    console.error(error.message)
  })
&lt;/code&gt;&lt;/pre&gt;&lt;hr /&gt;&lt;p&gt;That’s it. That’s the whole post. Though the snippet is ultimately pretty simple (it’s 20 lines without whitespace and comments) writing this provided me with three major benefits: it forced me to abstract the function to the most reusable version I could, it gave me an opportunity to research &lt;code&gt;AbortController&lt;/code&gt; to make sure I knew exactly how it behaved, and it provided a place where I can come find this snippet in the future instead of rooting through old projects.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Functional-First Accordions]]></title><description><![CDATA[Did you know that HTML basically has a built-in, fully functional accordion component? Well now you do.]]></description><link>https://nikhilnamal.netlify.com/blog/functional-first-accordions/</link><guid isPermaLink="false">https://nikhilnamal.netlify.com/blog/functional-first-accordions/</guid><pubDate>Sun, 30 Dec 2018 00:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;Update (December 2019):&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;In the year since I’ve wrote this, it’s become increasingly clear that this is not a good method for building accordions. Beyond all the work it takes to make the thing functional (you know, the point of this post), &lt;a href=&quot;https://daverupert.com/2019/12/why-details-is-not-an-accordion/&quot;&gt;Dave Rupert recently wrote a short post detailing the accessibility shortcomings of this approach&lt;/a&gt;. I share Dave’s opinion that the web, as a platform, needs to bring some of these common controls to the table to ensure a consistent, accessible experience for all of its users.&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;There are few UI components encountered as frequently as the accordion. Even if you’re unfamiliar with the term, you’re familiar with the pattern: a string of text, sometimes accompanied by a button or icon, that reveals more content underneath when clicked. Thousands of developers and hundreds of UI frameworks have created accordions, often with their own rigid markup structures and (potentially bloated) JavaScript. But did you know that a perfectly functional accordion component ships with &lt;a href=&quot;https://caniuse.com/#feat=details&quot;&gt;most modern browsers&lt;/a&gt;? Check this out:&lt;/p&gt;&lt;details&gt;&lt;summary&gt;This is my cool accordion&lt;/summary&gt;&lt;p&gt;100% HTML, baby. #usetheplatform&lt;/p&gt;&lt;/details&gt;&lt;p&gt;That’s all HTML! The code looks like this:&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;details&amp;gt;
  &amp;lt;summary&amp;gt;This is my cool accordion&amp;lt;/summary&amp;gt;

  &amp;lt;p&amp;gt;100% HTML, baby. #usetheplatform&amp;lt;/p&amp;gt;
&amp;lt;/details&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The element that helps us achieve this marvel of modern engineering is called &lt;a href=&quot;http://developer.mozilla.org/en-US/docs/Web/HTML/Element/details&quot;&gt;&lt;code&gt;details&lt;/code&gt;&lt;/a&gt; (along with &lt;code&gt;summary&lt;/code&gt; to set custom titles). It allows us to create content that is not visible until the element is clicked on. Sounds like an accordion to me!&lt;/p&gt;&lt;p&gt;Of course, there are some downsides to the &lt;code&gt;details&lt;/code&gt; element. For starters, it isn’t exactly what I’d call attractive. There’s no way to animate content in and out, and no way to adjust the “twistie” (the triangle icon that indicates the component state). In addition, working in &lt;em&gt;most&lt;/em&gt; modern browsers means that it doesn’t work in &lt;em&gt;all&lt;/em&gt; modern browsers, not to mention legacy browsers. But, much like our UI framework-developing forebears, we can use some CSS &amp;amp; JavaScript to solve those issues, with the added benefit of an accordion that works when JavaScript (and even CSS!) is disabled.&lt;/p&gt;&lt;h2&gt;The Beauty Is in the Details&lt;/h2&gt;&lt;p&gt;The first and easiest changes we should make just involve making the element display consistently in all browsers.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot;&gt;details {
  display: block;
}
summary {
  display: list-item;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Similarly easy, though a little more opinionated, is changing the cursor to highlight that the element is interactive.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot;&gt;summary {
  cursor: pointer;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now let’s get into the fun stuff. First up is changing the default twistie to be something closer to convention.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot;&gt;/* Hide the default twistie */
/* Spec-compliant: */
summary {
  list-style-type: none;
}
/* Non-standard: */
summary::-webkit-details-marker {
  display: none;
}

/* Display a more common one */
summary {
  position: relative;
  padding-right: 1.5rem;
}
summary::after {
  content: &apos;+&apos;;
  position: absolute;
  top: calc(50% - 0.5em);
  right: 0;
}
details[open] summary::after {
  content: &apos;-&apos;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&quot;https://codepen.io/lowmess/pen/zMjagE&quot;&gt;Here’s the accordion&lt;/a&gt; as it looks at this point:&lt;/p&gt;&lt;iframe height=&quot;300&quot; scrolling=&quot;no&quot; title=&quot;Details Accordion (CSS Resets Only)&quot; src=&quot;//codepen.io/lowmess/embed/zMjagE/?height=300&amp;amp;theme-id=22727&amp;amp;default-tab=result&quot; frameBorder=&quot;no&quot; allowtransparency=&quot;true&quot; allowFullScreen=&quot;true&quot; style=&quot;width: 100%;&quot;&gt;See the Pen &lt;a href=&quot;https://codepen.io/lowmess/pen/zMjagE/&quot;&gt;Details Accordion (CSS Resets Only)&lt;/a&gt; by Alec Lomas (&lt;a href=&quot;https://codepen.io/lowmess&quot;&gt;@lowmess&lt;/a&gt;) on &lt;a href=&quot;https://codepen.io&quot;&gt;CodePen&lt;/a&gt;.&lt;/iframe&gt;&lt;p&gt;Not bad for a few lines of CSS! There’s a few more changes I would make before calling this anything approaching good-looking, though.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot;&gt;details {
  border-bottom: 1px solid #eee;
  padding: 1rem;
}
:not(details) + details,
details:first-of-type {
  border-top: 1px solid #eee;
}

summary {
  margin-bottom: 0;
  font-weight: 700;
}
summary + * {
  margin-top: 1rem;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&quot;https://codepen.io/lowmess/pen/eQrjBG&quot;&gt;Now we’ve got a relatively attractive accordion component&lt;/a&gt;. We could stop now, and we would have a working component that, with a few tweaks, could be dropped onto almost any site and Just Work™️.&lt;/p&gt;&lt;iframe height=&quot;300&quot; scrolling=&quot;no&quot; title=&quot;Details Accordion (Base Styles)&quot; src=&quot;//codepen.io/lowmess/embed/eQrjBG/?height=300&amp;amp;theme-id=22727&amp;amp;default-tab=result&quot; frameBorder=&quot;no&quot; allowtransparency=&quot;true&quot; allowFullScreen=&quot;true&quot; style=&quot;width: 100%;&quot;&gt;See the Pen &lt;a href=&quot;https://codepen.io/lowmess/pen/eQrjBG/&quot;&gt;Details Accordion (Base Styles)&lt;/a&gt; by Alec Lomas (&lt;a href=&quot;https://codepen.io/lowmess&quot;&gt;@lowmess&lt;/a&gt;) on &lt;a href=&quot;https://codepen.io&quot;&gt;CodePen&lt;/a&gt;.&lt;/iframe&gt;&lt;h2&gt;Enchanting Progressive Enhancement&lt;/h2&gt;&lt;p&gt;We don’t want to be outdone by those UI frameworks of yore, though. So we’ll need to do a little more work to animate the content in and out. The base markup does have to be changed to be a little less clean, and we’ll need some new CSS.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;details&amp;gt;
  &amp;lt;summary&amp;gt;An updated details accordion&amp;lt;/summary&amp;gt;

  &amp;lt;div class=&amp;quot;content&amp;quot;&amp;gt;
    &amp;lt;p&amp;gt;I&apos;m some content!&amp;lt;/p&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/details&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot;&gt;.content {
  overflow-y: hidden;
  transition: all 0.4s ease;
}

.content.is-closed {
  max-height: 0;
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 0;
  padding-bottom: 0;
  opacity: 0;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You may have noticed that we didn’t apply the &lt;code&gt;is-closed&lt;/code&gt; class to the content in the markup. Since we’re using JS to trigger that class, and it hides the content, we only want to apply the class if JS is allowed to run on the page.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;for (const content of document.querySelectorAll(&apos;details .content&apos;)) {
  content.classList.add(&apos;is-closed&apos;)
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;There’s one last piece we need to set into place before we can trigger the animation. When the element is closed, it has an applied &lt;code&gt;max-height&lt;/code&gt; of &lt;code&gt;0&lt;/code&gt;. Since the &lt;code&gt;auto&lt;/code&gt; declaration is not animatable, we’ll need to apply a defined &lt;code&gt;max-height&lt;/code&gt; to the content when it’s open. For the smoothest possible animation, that &lt;code&gt;max-height&lt;/code&gt; should be the same size as the content height. We can write a simple function to calculate this height and store it as an attribute on the content element.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;const getContentHeight = node =&amp;gt; {
  // Force node to display properly
  node.classList.remove(&apos;is-closed&apos;)
  // Calculate height and store it
  node.setAttribute(&apos;data-height&apos;, `${node.getBoundingClientRect().height}px`)
  // Reset node to initial state
  node.classList.add(&apos;is-closed&apos;)
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now that we’ve accounted for that wrinkle, we can handle interaction on the element. In a bit of premature optimization, we’ll &lt;a href=&quot;https://javascript.info/event-delegation&quot;&gt;delegate the event&lt;/a&gt; to the document.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;document.addEventListener(&apos;click&apos;, event =&amp;gt; {
  if (!event.target.closest(&apos;summary&apos;)) {
    return
  }

  event.preventDefault()
})
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;All we’ve told the browser at this point is “if the user has clicked a &lt;code&gt;&amp;lt;summary&amp;gt;&lt;/code&gt; element, don’t do anything”. The default behavior associated with clicking a &lt;code&gt;&amp;lt;summary&amp;gt;&lt;/code&gt; element is to set/remove the &lt;code&gt;open&lt;/code&gt; attribute on its parent &lt;code&gt;&amp;lt;details&amp;gt;&lt;/code&gt; element (the browser then knows to hide/show the content inside of &lt;code&gt;&amp;lt;details&amp;gt;&lt;/code&gt; based on this attribute). The browser won’t wait for the content to animate out before hiding it, so we need to do that manually inside our handler. The code to do this is fairly straightforward, and boils down to toggling attributes and classes in a specific order at a specified time.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;// Inside of our event handler
const accordion = event.target.closest(&apos;details&apos;)
const content = accordion.querySelector(&apos;.content&apos;)

// Handle closing
if (accordion.hasAttribute(&apos;open&apos;)) {
  // Animate content out
  content.style.removeProperty(&apos;max-height&apos;)
  content.classList.add(&apos;is-closed&apos;)
  // Wait for animation to finish, then remove the `open` attribute
  window.setTimeout(() =&amp;gt; {
    accordion.removeAttribute(&apos;open&apos;)
  }, 400)
  // Exit handler
  return
}

// Handle opening
// Set the `open` attribute so the content will display
accordion.setAttribute(&apos;open&apos;, &apos;&apos;)
// If our content does not have a calculated height, calculate it
if (!content.hasAttribute(&apos;data-height&apos;)) {
  getContentHeight(content)
}
// Wait a beat for the height to calculate, then animate content in
window.setTimeout(() =&amp;gt; {
  content.style.maxHeight = content.getAttribute(&apos;data-height&apos;)
  content.classList.remove(&apos;is-closed&apos;)
}, 0)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&quot;https://codepen.io/lowmess/pen/yQjRXy&quot;&gt;Putting it all together&lt;/a&gt; gives us a fully functional, animated accordion component. And because we started with an HTML element that gives us our core functionality by default, a user doesn’t need to have JavaScript running to access the hidden content.&lt;/p&gt;&lt;iframe height=&quot;300&quot; scrolling=&quot;no&quot; title=&quot;&amp;lt;details&amp;gt; Accordion (Final Form)&quot; src=&quot;//codepen.io/lowmess/embed/yQjRXy/?height=300&amp;amp;theme-id=22727&amp;amp;default-tab=result&quot; frameBorder=&quot;no&quot; allowtransparency=&quot;true&quot; allowFullScreen=&quot;true&quot; style=&quot;width: 100%;&quot;&gt;See the Pen &lt;a href=&quot;https://codepen.io/lowmess/pen/yQjRXy/&quot;&gt;&amp;lt;details&amp;amp;rt; Accordion (Final Form)&lt;/a&gt; by Alec Lomas (&lt;a href=&quot;https://codepen.io/lowmess&quot;&gt;@lowmess&lt;/a&gt;) on &lt;a href=&quot;https://codepen.io&quot;&gt;CodePen&lt;/a&gt;.&lt;/iframe&gt;&lt;h2&gt;Extra Credit&lt;/h2&gt;&lt;p&gt;Although the accordion we’ve created is great, we’ve only covered the baseline functionality. There are a few ways we can change or improve the functionality further, including but not limited to:&lt;/p&gt;&lt;h3&gt;Improve Accessibility&lt;/h3&gt;&lt;p&gt;Because the &lt;code&gt;&amp;lt;details&amp;gt;&lt;/code&gt; element is baked-in to the platform, it should be accessible by default. However, this only applies to browsers that actually support the element. If you have users from browsers that don’t support the element, considerations for accessibility should be taken (adding &lt;code&gt;tabindex&lt;/code&gt; and &lt;code&gt;aria-&lt;/code&gt; attributes, for example).&lt;/p&gt;&lt;h3&gt;Handle Window Resizing&lt;/h3&gt;&lt;p&gt;The vertical expansion animation we’re using to transition accordion content in and out of view is smooth and natural, but there is one issue: it isn’t responsive. Because we only calculate the height of the element once, if the element width changes to the degree that the content flows to a new line, the animation will break. An ideal solution would account for this, and there are a variety of ways we could do so.&lt;/p&gt;&lt;h3&gt;Increase Interaction Target Size&lt;/h3&gt;&lt;p&gt;We set container padding on the &lt;code&gt;&amp;lt;details&amp;gt;&lt;/code&gt; element to give the contents of the accordion room to breath. However, this means to open the accordion you have to click or tap on the &lt;code&gt;&amp;lt;summary&amp;gt;&lt;/code&gt; content. Setting the padding on the &lt;code&gt;&amp;lt;summary&amp;gt;&lt;/code&gt; and content container independently should make the accordion a little easier to use.&lt;/p&gt;&lt;h3&gt;Animate the Twistie&lt;/h3&gt;&lt;p&gt;Animating the twistie to compliment the content animation would bring another level of polish to our accordion. Extra extra credit: make the animation happen on interaction (instead of relying on the &lt;code&gt;[open]&lt;/code&gt; attribute).&lt;/p&gt;&lt;h3&gt;Force Content to Show In Non-Screen Environments&lt;/h3&gt;&lt;p&gt;Accordions can bring a lot to the table in screen-based environments, however they can also make content inaccessible in non-screen environments (such as when printing or using a screenreader). The content should be accessible in all environments.&lt;/p&gt;&lt;h3&gt;Only Open One Item At a Time&lt;/h3&gt;&lt;p&gt;Just kidding. If &lt;a href=&quot;https://www.nngroup.com/articles/accordions-complex-content/&quot;&gt;you need an accordion at all&lt;/a&gt;, you probably &lt;a href=&quot;https://www.smashingmagazine.com/2017/06/designing-perfect-accordion-checklist/#designing-interaction-for-the-accordion&quot;&gt;should not do this&lt;/a&gt;. As it is an action not directly requested by the user, it can cause frustration.&lt;/p&gt;&lt;h3&gt;Package the Accordion Into a Reusable Component&lt;/h3&gt;&lt;p&gt;We should probably abstract away all of this markup to ensure consistency and improve DX. Frameworks like React and Vue provide a simple way to do this, but it should also be possible in most templating languages.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[A Better Album Ranking Algorithm]]></title><description><![CDATA[In its quest to glorify the scrobble, Last.fm has forgotten the humble album. We can almost fix that.]]></description><link>https://nikhilnamal.netlify.com/blog/a-better-album-ranking-algorithm/</link><guid isPermaLink="false">https://nikhilnamal.netlify.com/blog/a-better-album-ranking-algorithm/</guid><pubDate>Mon, 12 Mar 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Years ago, I deleted my &lt;a href=&quot;https://last.fm&quot;&gt;Last.fm&lt;/a&gt; account, because it felt like a dying social media network. Months ago, I created &lt;a href=&quot;https://www.last.fm/user/lowmess&quot;&gt;a new one&lt;/a&gt;, because Last.fm is a treasure trove of behaviorally generated personal data. It’s a lovely service for a developer to have around for side projects, as it provides instant and easy access to a large dataset with a particularly personal connection if you’re a music lover. In the process of using it for &lt;a href=&quot;/about/&quot;&gt;one of those side projects&lt;/a&gt;, I found a dark &amp;amp; disturbing secret: Last.fm actually kind of sucks for tracking album plays.&lt;/p&gt;&lt;p&gt;Fair warning: things are about to take a turn for the opinionated, pedantic, and downright trivial.&lt;/p&gt;&lt;h2&gt;The Scrobble Killed the Record Star&lt;/h2&gt;&lt;p&gt;Last.fm is built upon an atomic unit: the scrobble. From it, all other units are derived. A scrobble represents one play of one song, and Last.fm sets your top album by how many scrobbles it has. The problem with this is that it’s the complete wrong way to count album plays.&lt;/p&gt;&lt;p&gt;Album play counts are slightly different than song play counts. They should start from basically the same place — one playthrough is one playthrough — but from there they branch in subtle but important ways. For example, it is much more common to only partially listen to an album than it is to partially listen to a song. Albums are also, generally, between 10 and 12 times longer than songs, and broken into as many parts.&lt;/p&gt;&lt;p&gt;If the length of an album is what makes a complete playthrough of an album rarer than a playthrough of a song, a playthrough of a longer album should count for more than that of a shorter album. (There’s an argument to be made that the same is true of songs, but we’ll leave that for another day.) Thus, the ideal album ranking algorithm would account for total playthroughs, with a weight given to longer albums. Maybe even something as simple as this:&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;albumPlaythroughs * (1 + albumDuration / 2700)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, we weight the duration in 45 minute increments, the length of a single LP (&lt;code&gt;albumDuration&lt;/code&gt; being in seconds). Adding 1 to the duration calculation helps to ensure we’re not simply normalizing for record length — while that is also a valid way to rank album plays, it is not the one I prefer.&lt;/p&gt;&lt;h2&gt;Ok, You Got Me. Something Exactly As Simple As That&lt;/h2&gt;&lt;p&gt;Let’s take three albums of varying lengths and see how they handle this algorithm. Our albums:&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot;&gt;[
  {
    &amp;quot;name&amp;quot;: &amp;quot;Cardinal&amp;quot;,
    &amp;quot;artist&amp;quot;: &amp;quot;Pinegrove&amp;quot;,
    &amp;quot;duration&amp;quot;: 1845
  },
  {
    &amp;quot;name&amp;quot;: &amp;quot;Marquee Moon&amp;quot;,
    &amp;quot;artist&amp;quot;: &amp;quot;Television&amp;quot;,
    &amp;quot;duration&amp;quot;: 2754
  },
  {
    &amp;quot;name&amp;quot;: &amp;quot;Summertime &apos;06&amp;quot;,
    &amp;quot;artist&amp;quot;: &amp;quot;Vince Staples&amp;quot;,
    &amp;quot;duration&amp;quot;: 3545
  }
]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Given one playthrough each, the three records will be ranked in exactly the same order they are now. Let’s listen to a few more tracks.&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;const cardinalRank = 3.5 * (1 + 1845 / 2700) // 5.89
const marqueeRank = 3 * (1 + 2745 / 2700) // 6.05
const summertimeRank = 2.5 * (1 + 3545 / 2700) // 5.78
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now we’re getting somewhere. Even though &lt;em&gt;Cardinal&lt;/em&gt; has the most playthroughs, &lt;em&gt;Marquee Moon&lt;/em&gt; has the highest rank thanks to its lengthier runtime. &lt;em&gt;Summertime ‘06&lt;/em&gt; is just barely in third place despite having a full playthrough less than &lt;em&gt;Cardinal&lt;/em&gt;. The system works, folks.&lt;/p&gt;&lt;h2&gt;This Is the Part With the “But”&lt;/h2&gt;&lt;p&gt;Given all the information we need, the algorithm works. But we still have to get the information, and unfortunately, Last.fm doesn’t make it too easy on us:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;We can easily get a user’s top albums, but the response doesn’t include information on the amount of tracks on, or duration of, each album.&lt;/li&gt;&lt;li&gt;Last.fm doesn’t use unique IDs to track albums, so we have to use an endpoint that searches by album name and artist to get detailed album information. This often fails or retrieves the wrong album, even when the album name and artist are provided by Last.fm (like from the previously discussed endpoint).&lt;/li&gt;&lt;li&gt;Once we find an album, track listings are missing or incomplete about 20% of the time. This happens more often with newer albums.&lt;/li&gt;&lt;li&gt;Neither the top albums nor album info endpoints give us the album’s release year. This doesn’t impact the algorithm, I just thought it was odd.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;All told, to implement this algorithm on our own means we would have to make an insane amount of requests just to get incomplete or missing data. If you think that doesn’t sound like it’s worth it, you’re right. And while I didn’t use it, &lt;a href=&quot;https://gist.github.com/lowmess/f3c03b1a6fe50ee04622706047f8a654&quot;&gt;you can see an implementation here&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Last.fm still ranks albums wrong, though.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Customizing Tachyons]]></title><description><![CDATA[Tachyons is an insanely powerful atomic CSS library with sane defaults. But sane isn't perfect for every project.]]></description><link>https://nikhilnamal.netlify.com/blog/customizing-tachyons/</link><guid isPermaLink="false">https://nikhilnamal.netlify.com/blog/customizing-tachyons/</guid><pubDate>Mon, 27 Nov 2017 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;http://tachyons.io/&quot;&gt;Tachyons&lt;/a&gt;, if you haven’t heard, is incredible. It’s often called an atomic (or functional) CSS library, but if you spend enough time with it, you come to realize it’s something else entirely: a powerful and expressive framework for defining and consuming design system primitives.&lt;/p&gt;&lt;p&gt;The problem, then, is that not every design system will use the same primitives. While Tachyons has some great default settings to help you achieve just about any design you please, you often need to tweak some of those properties: a different color palette, or type scale, or you have sizing needs outside of the scope of the defaults. How should you go about customizing this CSS file that has nearly every property:value pair in CSS?&lt;/p&gt;&lt;h2&gt;K.I.S.S., Stupid&lt;/h2&gt;&lt;p&gt;The simplest solution is the most oft-overlooked: just frickin’ copy the files into your project and start hacking away. The good folks over at Tachyons HQ even cooked up a &lt;a href=&quot;https://github.com/tachyons-css/tachyons-cli&quot;&gt;CLI&lt;/a&gt; so you don’t have to goof around with a build process.&lt;/p&gt;&lt;h2&gt;Get Sassy&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://sass-lang.com/&quot;&gt;Sass&lt;/a&gt; has come to be the defacto CSS preprocessor. It brings a bunch of goodies to CSS: nesting, functions, and of course, variables. This makes it a great way to consume and customize libraries. And wouldn’t you know it, there’s an &lt;a href=&quot;https://github.com/tachyons-css/tachyons-sass&quot;&gt;official Sass fork&lt;/a&gt; of Tachyons ready to be brought into the fold of your Sass projects.&lt;/p&gt;&lt;h2&gt;Deliver Some Packages&lt;/h2&gt;&lt;p&gt;Did you know that nearly every Tachyons module is &lt;a href=&quot;https://www.npmjs.com/browse/keyword/tachyons&quot;&gt;available independently on npm&lt;/a&gt;? If you only need to customize a few of them (like, say, the typography scale), you can simply replace the default modules for your custom ones. The downside to this is that you have to import every single module you want to use into your project, but the folks over at &lt;a href=&quot;https://github.com/eggheadio/tachyons-egghead&quot;&gt;Egghead don’t seem to mind&lt;/a&gt;.&lt;/p&gt;&lt;h2&gt;It’s Your Property, Do What You Want With It&lt;/h2&gt;&lt;p&gt;Much like Sass before it, CSS itself is getting variable functionality (and &lt;a href=&quot;https://caniuse.com/#feat=css-variables&quot;&gt;browser support is pretty good&lt;/a&gt; too). Wouldn’t it be great if Tachyons used this new syntax to define all of the properties we’d like to update? Meet &lt;a href=&quot;https://github.com/tachyons-css/tachyons-custom&quot;&gt;&lt;code&gt;tachyons-custom&lt;/code&gt;&lt;/a&gt;, who I’m sure you saw standing just off stage-right over there. Simply include it in your project, and because CSS custom properties follow the cascade, any of your variables will overwrite the Tachyons defaults.&lt;/p&gt;&lt;h2&gt;Generate the Future, Today&lt;/h2&gt;&lt;p&gt;Tachyons HQ is hard at work developing a &lt;a href=&quot;https://github.com/tachyons-css/tachyons-generator&quot;&gt;Tachyons Generator&lt;/a&gt;. This tool allows you to describe your Tachyons variables in JSON and have a full-on version of Tachyons spit back out at you. This is the tool I am most excited about, because it has the potential to completely automate all of the other customization options we just went over while &lt;em&gt;also&lt;/em&gt; being more expressive and powerful. And that’s a beautiful thing.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[A Form-Fitted Z Shell]]></title><description><![CDATA[How I made my Z shell work for me, and how you might be able to maybe make yours work for you too.]]></description><link>https://nikhilnamal.netlify.com/blog/a-form-fitted-z-shell/</link><guid isPermaLink="false">https://nikhilnamal.netlify.com/blog/a-form-fitted-z-shell/</guid><pubDate>Wed, 27 Sep 2017 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;I was scared of the terminal for a long time. For a while, I got by: there are plenty of apps to compile Sass files. But as I grew frustrated with the limitations of GUI solutions, I took the time to familiarize myself with the command line. As with any other tool I eventually went through &lt;a href=&quot;https://twitter.com/lowmess/status/903714807022469120&quot;&gt;several obsessive rounds&lt;/a&gt; of tweaking and updating the terminal to my liking. Now, instead of being scared of the terminal, I don’t completely hate it. Here’s some of the ways I did that.&lt;/p&gt;&lt;h2&gt;The Light at the End of the Tunnel&lt;/h2&gt;&lt;p&gt;After going through all of this, this is what my terminal looks like. I prefer a minimal setup, but there’s a lot of features hidden underneath the simple exterior. Like a spooky skeleton.&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px;&quot; class=&quot;gatsby-resp-image-wrapper&quot;&gt;
      &lt;span style=&quot;padding-bottom: 56.90104166666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+ElEQVQoz52SW1PaQBSAUy5qOx2RvNqqFBMgAZKQy242ISGAgtPRau2zPPgzO/0lpO2MTvsjSpLTsyFKL1Mf+vDNZs+e82X37AqCIJeIo717Y/Ru96Xu4qDTXxy0tcWhoi2OVH0Dzg/5WgGPNTbrt0eqdvWyVi8JgvCiZrn03pyG0GcjUIkPKnOhZVGQDALygBQjhZbpQttiOTz2AI83+9b3rZ3nuygURDI5W1rhCU9cYWHStt3En58nOE8kgybHupNoLErG59fJ5OJDPprhSYKiRBrQHy2TAeZ8rm5ti1xYJ9FpTKdnuLthikmZ4viZMZxkLZNmMsLHtkUz1WGZYhdgTsdiGe6Qi1Fof3kQimY4jYO3V2AH43QwjIBO5tBzQ1AIy1EdD3SPguGRnC7hBHmL8ETpeof210JYEhXHi3vBHJrBZSq5p+ue/dKjNTSH93L9/bj2h/BZRcQjxOZoBvLsJpXIOL8IeeDmxRtIISO/xf8Wlqt17MWyj0dsjy5XUnCRNu0oPabTVOI4o5QXPcEq76FmP16KqLHwzppdgzp+D31vApo/hi7/ge3j82FPg7KO44OkO9+q2zu5sKba7KPuRXeKSZYa9WPTj2LFpHGzN4jx0cYN1UD0f7FsdI17fPifypXqnrBX2y2j9BXSQuT/hNe+Rio/AVKoEhlXxYm9AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot; class=&quot;gatsby-resp-image-background-image&quot;&gt;&lt;/span&gt;
  &lt;img alt=&quot;My Hyper terminal, showing some configuration&quot; title=&quot;My Hyper terminal, showing some configuration&quot; src=&quot;/static/5793872c2ca37e44670d9a485636d9fd/e5715/result.png&quot; srcSet=&quot;/static/5793872c2ca37e44670d9a485636d9fd/804b2/result.png 384w,/static/5793872c2ca37e44670d9a485636d9fd/e5715/result.png 768w&quot; sizes=&quot;(max-width: 768px) 100vw, 768px&quot; style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0;&quot; loading=&quot;lazy&quot; class=&quot;gatsby-resp-image-image&quot; /&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h2&gt;Frameworks: Almost Certainly All You Need&lt;/h2&gt;&lt;p&gt;Frameworks like &lt;a href=&quot;http://ohmyz.sh/&quot;&gt;&lt;code&gt;oh-my-zsh&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://github.com/sorin-ionescu/prezto&quot;&gt;&lt;code&gt;prezto&lt;/code&gt;&lt;/a&gt; are awesome, and originally what sent me down this crazy path. However, over time I became dissatisfied with them. The problem—which, really, says much more about me than the frameworks—was that they’re simply &lt;em&gt;too&lt;/em&gt; powerful. There are too many functions and aliases and configuration options for me to easily wrap my mind around. So, rather than do the normal thing (read some docs and root around in the repo), I decided to spend a few hours to make a shell setup that has like 5% of the functionality.&lt;/p&gt;&lt;p&gt;I concede that doing the exact opposite of this is not only completely justified, but probably much smarter as well.&lt;/p&gt;&lt;h2&gt;Wheels Are for Sweet Bike Jumps, Not Reinvention&lt;/h2&gt;&lt;p&gt;Fortunately, developer tooling is a realm where open source truly shines. There are literally dozens of FOSS projects that offer a more focused take on shell improvement. Chief among these is &lt;a href=&quot;https://brew.sh/&quot;&gt;Homebrew&lt;/a&gt;, which helps me install &lt;a href=&quot;https://github.com/unixorn/awesome-zsh-plugins#plugins&quot;&gt;these other libraries&lt;/a&gt; with just a few keystrokes. Here are a few of my other favorites.&lt;/p&gt;&lt;h3&gt;&lt;a href=&quot;https://github.com/olivierverdier/zsh-git-prompt&quot;&gt;&lt;code&gt;zsh-git-prompt&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The first thing that caused me to switch from &lt;code&gt;bash&lt;/code&gt; to &lt;code&gt;zsh&lt;/code&gt; and to use frameworks like &lt;code&gt;oh-my-zsh&lt;/code&gt; was the ability to see my &lt;code&gt;git&lt;/code&gt; status right in my prompt. I later realized that it was entirely possible to achieve without using either of those things, but it’s a still a good segue. This appropriately-named project helps make that easy, and after &lt;a href=&quot;https://github.com/lowmess/dotfiles/blob/e7bc15f22ba756a0106285229e0c930ee4f6dd0a/.zshrc#L24-L41&quot;&gt;some quick configuration&lt;/a&gt;, I was able to get my prompt looking just as I like it.&lt;/p&gt;&lt;h3&gt;&lt;a href=&quot;https://github.com/zsh-users/zsh-syntax-highlighting&quot;&gt;&lt;code&gt;zsh-syntax-highlighting&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Another convenient thing the frameworks bring is syntax highlighting. I can’t count the amount of times highlighting has prevented me from typing &lt;code&gt;gti&lt;/code&gt; (a type of car) instead of &lt;code&gt;git&lt;/code&gt; (a cool and good technology). Just source this also-appropriately-named package at the end of your &lt;code&gt;.zshrc&lt;/code&gt; and be dazzled at the pretty, prettily-informative colors.&lt;/p&gt;&lt;h3&gt;&lt;a href=&quot;https://hub.github.com&quot;&gt;&lt;code&gt;hub&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;I am working in &lt;a href=&quot;https://github.com&quot;&gt;GitHub&lt;/a&gt; repos basically all day. And while those repos work just fine with vanilla &lt;code&gt;git&lt;/code&gt;, GitHub has a helper library to make working with repos on their service a little easier. &lt;code&gt;hub&lt;/code&gt; allows you to do basically anything you can do on the GitHub webapp right from your terminal. My favorite feature is &lt;code&gt;browse&lt;/code&gt;, which allows you to quickly open up a repo’s GitHub page from the comfort of your keyboard instead of manually opening a tab like a jackass.&lt;/p&gt;&lt;h3&gt;&lt;a href=&quot;https://github.com/rupa/z&quot;&gt;&lt;code&gt;z&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;One of the first things I did when I started customizing my terminal was to set up custom aliases to jump into directories from anywhere. Judging by some of my coworkers setups, this is far from uncommon. Luckily, &lt;code&gt;z&lt;/code&gt; makes that irrelevant. Instead of setting up new aliases for every directory, just &lt;code&gt;cd&lt;/code&gt; into it one time, and then you can &lt;code&gt;z [name of dir]&lt;/code&gt; into it from anywhere. What sets &lt;code&gt;z&lt;/code&gt; apart from similar libraries like &lt;a href=&quot;https://github.com/wting/autojump&quot;&gt;&lt;code&gt;autojump&lt;/code&gt;&lt;/a&gt; is a concept called “frecency”. Basically, if you’ve been accessing a directory a lot recently, &lt;code&gt;z&lt;/code&gt; will score that directory higher than other similarly-named ones. Plus it sounds like the name of a really bad action movie, and that’s cool.&lt;/p&gt;&lt;h2&gt;Like a $3,000 Custom-Tailored Fingerless Glove&lt;/h2&gt;&lt;p&gt;Now that we have all of the libraries we want installed, we can begin to craft aliases and functions to mold our development environment to our own unique sensibilities. One of the major benefits I’ve found of doing this over using frameworks is that any additional feature or effeciency in my shell is one that I introduced, which means that I actually know about it and will use it. Probably. Honestly I give it like a 65% chance.&lt;/p&gt;&lt;p&gt;These can be simple:&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;# because typing an extra 7 chars is just too much work
alias r=&amp;quot;yarn run&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;These can be fun:&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;# yes, dude, the weather is fun
function weather() {
  curl -H &amp;quot;Accept-Language: ${LANG%_*}&amp;quot; wttr.in/&amp;quot;${1:-Tempe}&amp;quot;?0q
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;But the most important factor is that they’re mine (or, in your case, yours).&lt;/p&gt;&lt;h2&gt;The Real Terminal Is the Friends We Made Along the Way&lt;/h2&gt;&lt;p&gt;I am still the absolute furthest thing from an expert in this realm. But this process has made me a lot more comfortable on the command line. I don’t really have a great way to wrap this up, so I’ll leave you with this:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;If you &lt;em&gt;are&lt;/em&gt; an expert in this realm, come make fun of &lt;a href=&quot;https://github.com/lowmess/dotfiles&quot;&gt;my bad dotfiles repo&lt;/a&gt;. If you’re not an expert you can look at in awe or whatever.&lt;/li&gt;&lt;li&gt;Again, this entire process could have been avoided by just reading some docs. This was way more fun.&lt;/li&gt;&lt;/ol&gt;</content:encoded></item></channel></rss>